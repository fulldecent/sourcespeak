<?php
  $fd = fopen(\'cache/hack\',\'w\') or die(\'could not open temp file\');
  $source = str_replace(\"\\0A\\0D\",\"\\0D\",$_POST[\'code\']);
  fwrite($fd, $source);
  fclose($fd);

  $filename_raw  = \'cache/hack\';
  $filename_pretty = \'cache/tmp.html\';

  $cmd = \"vim -e +\\\"source ./highlight.vim\\\" \\\"$filename\\\" 2>&1\";

  passthru ($cmd);

  $pretty_source = file(\'cache/tmp.html\');

?>
<html>
<head>
  <link rel=\"stylesheet\" href=\"themes/common.css\" type=\"text/css\">
</head>
<body>
  <center>
    <table width=\"80%\">
      <tr valign=top>
        <td align=left>
          <pre>
<?php foreach($pretty_source as $line) echo trim($line).\"\\n\"; ?>
          </pre>
